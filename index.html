<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="css/main.css?v=3.4">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital@1&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Lato&display=swap" rel="stylesheet">

    <title>Manager App</title>
</head>
<body>
    
        


        <div class="container">
    
            <div class="bloque borderBottom " style="color: rgba(0, 0, 0, 0.7); padding-top: 30px;">
                <img src="img/profile.jpg" alt="">
                <div class="cuenta"> 
                    <p class="money">Your Money</p>
                     <p class="cant" id="saldo"> 0 </p> 
                </div>
            </div>


            <div class="bloque " style="box-shadow: 0px 0px 2px #888;margin-top:55px" id="contEnt">
             
            </div>

            
      
        
            <div class="button" id="button" >
                <a href="#">+</a>
            </div>
        </div>


        <div class="input" id="inputMainBill">

            <form action="">

                <div class="item" id="item">                        
                        <div class="image">
                            <img src="img/profile.jpg" alt="">
                        </div>
                        <i class="material-icons close" >close</i>
                            <div class="total" id="total"></div>
                            <div class="cont">
                                <input type="text" id="entidad" required=""  >
                                <label for="" id="labelEnt">Ingresa la entidad</label>
                            </div>                    
                            <select name="transaccion" id="transaccion">
                                <option value="">Elige un tipo de operacion</option>
                                <option value="0" id="deuda">Deuda</option>
                                <option value="1" id="ingreso">Ingreso</option>
                            </select>
                        <input type="number" id="valor" name="valor" min="0" max="100"> 
                        <input type="button" value="CONFIRM" id="enviarOperacion">
                </div>

            </form>
        </div>

     
        <script>

            //este variable permite llamar al popup
            var buttonMenu = document.getElementById("button");

            //aqui se llama al id que contiene el popup
            var inputMainBill = document.getElementById("inputMainBill");

            //esta variable llama al elemento que va a cerrar el popup
            var closeInput = document.querySelector(".item .close");

            //Estas variables son para hacer las respectivas operaciones de agregar o restar el saldo
            var ingreso = document.getElementById("ingreso");
        
            //mostrara el total
            var total = document.getElementById("saldo");

            //Esta variable capturara el nombre de la entidad
            var entidad = document.getElementById("entidad");


            //variable que contiene el label para animar el input
            var labelEnt = document.getElementById("labelEnt");


            var enviarOperacion = document.getElementById("enviarOperacion");

            //este evento animara el input al agregar una entidad
            entidad.addEventListener('focus', animaInput);

           //var item = document.getElementById("item");

            enviarOperacion.addEventListener('click', realizarOperacion);

            closeInput.addEventListener('click', closeInputPopup);

            buttonMenu.addEventListener('click', addDebito);
           //item.addEventListener('click',devuelveLabel);

            function animaInput(){
        
                var entidad = document.getElementById("entidad");
                console.log(entidad.value);

                if(document.getElementById("entidad").focus()){
                    console.log("No tengo nada");
                }else{
                    console.log("Tengo un")
                }
                /*

                if(  entidad.value == "" ){
                    labelEnt.style.top = '-25px';labelEnt.style.fontSize = '14px';  
                    console.log(entidad.focus());
                    console.log("ingrese aqui");
                }else{
                    console.log(entidad.value);
                    console.log("estoy aplicando estos estilos");
                    labelEnt.style.top = '0',labelEnt.style.fontSize = '16px';
                   
                }
                */
              
            }

          function devuelveLabel (){

                    labelEnt.style.top = '0',labelEnt.style.fontSize = '16px';
                    console.log("estoy aplicando estos estilos");
              
            }

            var suma = 0;   

            //var datos = [['cajero ath', 200, 1], ['claro', 150, 0],['bancolombia', 300, 1],['Banco Bogota', 170, 0]];

            var datos = [];

            var saldo = 0;
          
            function determinaTransaccion (){

              // var datos = [['cajero ath', 200, 1], ['claro', 150, 0],['bancolombia', 300, 1],['Banco Bogota', 170, 0]];
            
              var datos = []
                
              for(var i = 0; i < datos.length; i++){

                determina = datos[i][2]; 
                console.log(datos[i][1]);
                if(determina == 1){
                    saldo+= datos[i][1];
                    console.log("Es una suma");
                }else if(determina == 0){
                    saldo-= datos[i][1];
                    console.log("He restado");
                }

              }
              console.log("Soy el saldo" + saldo);
            }

            determinaTransaccion();

            var suma2 = 0;

            var contEnt = document.getElementById("contEnt");
            var contCant = document.getElementById("contCant");

            function creaElemento(){
                
                var ent = document.getElementById("entidad");
                ent = ent.value;

                var valor = document.getElementById("valor");
               valor = valor.value;

             

                var div = document.createElement("div");
                var content = document.createTextNode(ent);
                div.appendChild(content);

                div.classList = "entidad";

                var div2 = document.createElement("div");
                var cont2 = document.createTextNode(valor);
                div2.appendChild(cont2);
                div2.classList = "entidad";

                var divCont = document.createElement("div");
                divCont.classList ="flex";
                divCont.appendChild(div);
                divCont.appendChild(div2);
        
        

                var contEnt = document.getElementById("contEnt");
                contEnt.appendChild(divCont);
              
            }

           function realizarOperacion(){


            var ent = document.getElementById("entidad");
         //   deuda = deuda.value;
         //   ingreso = ingreso.value;
             ent = ent.value;

              
            var transaccion =  document.getElementById("transaccion").value;

                saldo = 0;
               console.log(transaccion);


               var valor = document.getElementById("valor");
               valor = valor.value;
               valor = [ent , parseInt(valor) , parseInt(transaccion)] ;

               console.log(valor);

               datos.push(valor);

               console.log(datos);             

                console.log( typeof(valor));

                for(var i = 0; i < datos.length ; i++){
    

                  //  suma+= datos[i][1];
                    //console.log( suma);
                    determina = datos[i][2]; 
                console.log(datos[i][1]);
                if(determina == 1){
                    saldo+= datos[i][1];
                    console.log("Es una suma");
                }else if(determina == 0){
                    saldo-= datos[i][1];
                    console.log("He restado");
                }
                }
                //console.log("Debo arrojar un monto" + datos[0][1]);
                creaElemento();
                total.innerHTML = `${saldo} <span class>USD</span>` ;
                console.log("Soy el saldo total: " + saldo);
                saldo = 0;
                suma = 0;

               
                
           }

         


           function closeInputPopup(){
               console.log("Cerrare el popup");
               inputMainBill.style.display = "none";
           } 

           function addDebito (){
                console.log("Voy a agregar un debito ");

                inputMainBill.style.display="block";

            }





              
        </script>

</body>
</html>